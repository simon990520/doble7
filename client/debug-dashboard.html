<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Dashboard - Doble7</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="notification-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header class="dashboard-header">
            <div class="header-content">
                <div class="header-left">
                    <div class="logo-section">
                        <div class="logo-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="currentColor"/>
                                <path d="M19 15L19.74 17.74L22.5 18.5L19.74 19.26L19 22L18.26 19.26L15.5 18.5L18.26 17.74L19 15Z" fill="currentColor"/>
                                <path d="M5 6L5.5 7.5L7 8L5.5 8.5L5 10L4.5 8.5L3 8L4.5 7.5L5 6Z" fill="currentColor"/>
                            </svg>
                        </div>
                        <div class="logo-text">
                            <h1>Doble7</h1>
                            <span class="logo-subtitle">Debug Dashboard</span>
                        </div>
                    </div>
                </div>
                
                <div class="header-right">
                    <div class="user-info">
                        <span class="user-phone" id="user-phone">-</span>
                        <button class="btn btn-small" onclick="logout()">Cerrar Sesión</button>
                    </div>
                    
                    <!-- Botón de Notificaciones -->
                    <div class="notifications-wrapper">
                        <button class="btn btn-icon notifications-btn" onclick="showNotificationsPanel()" title="Notificaciones">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge" id="notification-badge">0</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main class="dashboard-content">
            <section class="investment-summary">
                <h2>Resumen de Inversión</h2>
                <div class="summary-cards">
                    <div class="summary-card">
                        <h3>Total Invertido</h3>
                        <p class="amount" id="current-investment">$0</p>
                    </div>
                    <div class="summary-card">
                        <h3>Fecha de Inversión</h3>
                        <p id="investment-date">-</p>
                    </div>
                    <div class="summary-card">
                        <h3>Disponible para Retiro</h3>
                        <p id="withdrawal-date">-</p>
                    </div>
                    <div class="summary-card">
                        <h3>Estado</h3>
                        <p id="investment-status">Sin inversión activa</p>
                    </div>
                </div>
            </section>

            <!-- Sistema de Referidos -->
            <section class="referral-system">
                <h2>Sistema de Referidos</h2>
                <div class="referral-info">
                    <div class="referral-card">
                        <h3>Tu Código de Referido</h3>
                        <div class="code-container">
                            <span class="referral-code" id="my-referral-code">-</span>
                            <button class="btn btn-small" onclick="copyReferralCode()">Copiar</button>
                        </div>
                    </div>
                    <div class="referral-card">
                        <h3>Referidos Activos</h3>
                        <p class="referral-count"><span id="active-referrals">0</span> / 3</p>
                        <small>Necesitas 3 referidos activos para retirar</small>
                    </div>
                </div>
            </section>

            <!-- Historial de Inversiones -->
            <section class="investment-history">
                <h2>Historial de Inversiones</h2>
                <div class="history-container">
                    <div id="history-list">
                        <!-- Se llena dinámicamente -->
                    </div>
                </div>
            </section>

            <!-- Debug Info -->
            <section class="actions">
                <h2>Información de Debug</h2>
                <div class="summary-cards">
                    <div class="summary-card">
                        <h3>Estado de Firebase</h3>
                        <p id="firebase-status">Cargando...</p>
                    </div>
                    <div class="summary-card">
                        <h3>Usuario Actual</h3>
                        <p id="current-user-debug">No autenticado</p>
                    </div>
                    <div class="summary-card">
                        <h3>Sistema de Notificaciones</h3>
                        <p id="notification-system-status">No inicializado</p>
                    </div>
                </div>
            </section>

            <section class="actions">
                <h2>Logs de Debug</h2>
                <div id="debug-logs" style="background: #f8f9fa; padding: 20px; border-radius: 12px; max-height: 400px; overflow-y: auto; font-family: monospace; font-size: 12px;">
                    <p>Los logs aparecerán aquí...</p>
                </div>
            </section>
        </main>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

    <!-- Scripts -->
    <script src="notifications.js"></script>
    <script src="script.js"></script>
    
    <script>
        // Función para agregar logs
        function addLog(message) {
            const logsContainer = document.getElementById('debug-logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('p');
            logEntry.innerHTML = `<span style="color: #666;">[${timestamp}]</span> ${message}`;
            logsContainer.appendChild(logEntry);
            logsContainer.scrollTop = logsContainer.scrollHeight;
        }

        // Función para actualizar estado de debug
        function updateDebugStatus() {
            const firebaseStatus = document.getElementById('firebase-status');
            const currentUserDebug = document.getElementById('current-user-debug');
            const notificationSystemStatus = document.getElementById('notification-system-status');
            
            // Estado de Firebase
            if (typeof firebase !== 'undefined') {
                firebaseStatus.textContent = 'Firebase disponible';
                firebaseStatus.style.color = '#28a745';
            } else {
                firebaseStatus.textContent = 'Firebase no disponible';
                firebaseStatus.style.color = '#dc3545';
            }
            
            // Usuario actual
            if (typeof currentUser !== 'undefined' && currentUser) {
                currentUserDebug.textContent = currentUser.uid;
                currentUserDebug.style.color = '#28a745';
            } else {
                currentUserDebug.textContent = 'No autenticado';
                currentUserDebug.style.color = '#dc3545';
            }
            
            // Sistema de notificaciones
            if (typeof notificationSystem !== 'undefined') {
                notificationSystemStatus.textContent = 'Inicializado';
                notificationSystemStatus.style.color = '#28a745';
            } else {
                notificationSystemStatus.textContent = 'No inicializado';
                notificationSystemStatus.style.color = '#dc3545';
            }
        }

        // Interceptar console.log para mostrar en la página
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addLog('LOG: ' + args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addLog('ERROR: ' + args.join(' '));
        };

        // Actualizar estado cada 2 segundos
        setInterval(updateDebugStatus, 2000);

        // Mostrar logs iniciales
        document.addEventListener('DOMContentLoaded', function() {
            addLog('Página de debug del dashboard cargada');
            addLog('Esperando inicialización de Firebase...');
        });
    </script>
</body>
</html> 